<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Registration</title>

    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
        }
        
        .form-wizard-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        /* Progress Bar */
        .progress-container {
            display: flex;
            align-items: center;
            margin-bottom: 40px;
            padding: 20px 0;
        }
        
        .progress-step {
            flex: 1;
            text-align: center;
            position: relative;
        }
        
        .progress-bullet {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #e0e0e0;
            color: #999;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .progress-step.active .progress-bullet,
        .progress-step.completed .progress-bullet {
            background-color: #4CAF50;
            color: white;
        }
        
        .progress-step.active .progress-label {
            color: #4CAF50;
            font-weight: 600;
        }
        
        .progress-label {
            margin-top: 8px;
            font-size: 14px;
            color: #666;
        }
        
        .progress-line {
            flex: 1;
            height: 2px;
            background-color: #e0e0e0;
            margin: 0 -20px;
            transform: translateY(-20px);
        }
        
        .progress-step.completed + .progress-line {
            background-color: #4CAF50;
        }
        
        /* Form Steps */
        .form-step {
            display: none;
            animation: slideIn 0.3s ease-out;
        }
        
        .form-step.active {
            display: block;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .form-step h2 {
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .step-description {
            color: #666;
            margin-bottom: 30px;
        }
        
        /* Form Fields */
        .form-field {
            margin-bottom: 20px;
        }
        
        .form-field label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .form-field input,
        .form-field select,
        .form-field textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .form-field input:focus,
        .form-field select:focus,
        .form-field textarea:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
        
        .form-field input.error,
        .form-field select.error,
        .form-field textarea.error {
            border-color: #f44336;
        }
        
        .required {
            color: #f44336;
            margin-left: 3px;
        }
        
        .help-text {
            display: block;
            margin-top: 5px;
            color: #666;
            font-size: 14px;
        }
        
        .validation-message {
            color: #f44336;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
        
        .validation-message.show {
            display: block;
        }
        
        /* Radio and Checkbox Groups */
        .radio-group,
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .radio-label,
        .checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .radio-label input,
        .checkbox-label input {
            width: auto;
            margin-right: 8px;
        }
        
        /* Navigation Buttons */
        .form-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .btn {
            padding: 10px 30px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-primary {
            background-color: #2196F3;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1976D2;
        }
        
        .btn-secondary {
            background-color: #757575;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #616161;
        }
        
        .btn-success {
            background-color: #4CAF50;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #45a049;
        }
        
        /* Summary */
        #summaryContainer {
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        .summary-section {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 4px;
        }
        
        .summary-section h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .summary-field {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .summary-label {
            font-weight: 500;
            color: #555;
        }
        
        .summary-value {
            color: #333;
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            .form-wizard-container {
                padding: 20px;
            }
            
            .progress-label {
                font-size: 12px;
            }
            
            .progress-bullet {
                width: 30px;
                height: 30px;
                font-size: 14px;
            }
            
            .form-navigation {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>

</head>
<body>
    <div class="form-wizard-container">
<div class="progress-container">
                <div class="progress-step active" data-step="0">
                    <div class="progress-bullet">1</div>
                    <div class="progress-label">Personal Information</div>
                </div>
            <div class="progress-line"></div>
                <div class="progress-step " data-step="1">
                    <div class="progress-bullet">2</div>
                    <div class="progress-label">Address</div>
                </div>
            <div class="progress-line"></div>
                <div class="progress-step " data-step="2">
                    <div class="progress-bullet">3</div>
                    <div class="progress-label">Payment Method</div>
                </div>
            </div>
        <form id="wizardForm" action="/api/complete-registration" method="POST" novalidate>
            <div class="form-steps-container">

        <div class="form-step" data-step="0">
            <h2>Personal Information</h2>
            <p class="step-description">Let's start with your basic information</p>
            <div class="form-fields">
        <div class="form-field " data-field-name="first_name"><label for="first_name_step0">First Name<span class="required">*</span></label><input type="text" id="first_name_step0" name="first_name" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="last_name"><label for="last_name_step0">Last Name<span class="required">*</span></label><input type="text" id="last_name_step0" name="last_name" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="date_of_birth"><label for="date_of_birth_step0">Date Of Birth<span class="required">*</span></label><input type="date" id="date_of_birth_step0" name="date_of_birth" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="phone"><label for="phone_step0">Phone</label><input type="tel" id="phone_step0" name="phone" value="" placeholder="" ><div class="validation-message"></div></div>
            </div>
        </div>
        
        <div class="form-step" data-step="1">
            <h2>Address</h2>
            <p class="step-description">Where should we send your order?</p>
            <div class="form-fields">
        <div class="form-field " data-field-name="street_address"><label for="street_address_step1">Street Address<span class="required">*</span></label><input type="text" id="street_address_step1" name="street_address" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="city"><label for="city_step1">City<span class="required">*</span></label><input type="text" id="city_step1" name="city" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="state"><label for="state_step1">State<span class="required">*</span></label><input type="text" id="state_step1" name="state" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="zip_code"><label for="zip_code_step1">Zip Code<span class="required">*</span></label><input type="text" id="zip_code_step1" name="zip_code" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="country"><label for="country_step1">Country</label><input type="text" id="country_step1" name="country" value="" placeholder="" ><div class="validation-message"></div></div>
            </div>
        </div>
        
        <div class="form-step" data-step="2">
            <h2>Payment Method</h2>
            <p class="step-description">Secure payment information</p>
            <div class="form-fields">
        <div class="form-field " data-field-name="card_type"><label for="card_type_step2">Card Type<span class="required">*</span></label><input type="text" id="card_type_step2" name="card_type" value="" placeholder="" required="required"><small class="help-text">Credit or Debit</small><div class="validation-message"></div></div><div class="form-field " data-field-name="card_number"><label for="card_number_step2">Card Number<span class="required">*</span></label><input type="text" id="card_number_step2" name="card_number" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="expiry_month"><label for="expiry_month_step2">Expiry Month<span class="required">*</span></label><input type="number" id="expiry_month_step2" name="expiry_month" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="expiry_year"><label for="expiry_year_step2">Expiry Year<span class="required">*</span></label><input type="number" id="expiry_year_step2" name="expiry_year" value="" placeholder="" required="required"><div class="validation-message"></div></div><div class="form-field " data-field-name="cvv"><label for="cvv_step2">Cvv<span class="required">*</span></label><input type="text" id="cvv_step2" name="cvv" value="" placeholder="" required="required"><div class="validation-message"></div></div>
            </div>
        </div>
        
            </div>
            
            <!-- Navigation buttons -->
            <div class="form-navigation">
                <button type="button" class="btn btn-secondary" id="prevBtn" onclick="changeStep(-1)" style="display: none;">Previous</button>
                <button type="button" class="btn btn-primary" id="nextBtn" onclick="changeStep(1)">Next</button>
                <button type="submit" class="btn btn-success" id="submitBtn" style="display: none;">Submit</button>
            </div>
        </form>
        
        <!-- Summary/Confirmation -->
        <div id="summaryContainer" style="display: none;">
            <h2>Submission Summary</h2>
            <div id="summaryContent"></div>
            <button type="button" class="btn btn-primary" onclick="editForm()">Edit</button>
            <button type="button" class="btn btn-success" onclick="confirmSubmission()">Confirm & Submit</button>
        </div>
    </div>

    <script>
        // Form Wizard State
        let currentStep = 0;
        const formData = {};
        const form = document.getElementById('wizardForm');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const submitBtn = document.getElementById('submitBtn');
        const summaryContainer = document.getElementById('summaryContainer');
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showStep(currentStep);
            loadSavedProgress();
            
            // Add form submit handler
            form.addEventListener('submit', handleSubmit);
            
            // Add input change handlers for saving progress
            form.addEventListener('input', saveProgress);
            form.addEventListener('change', saveProgress);
        });
        
        function showStep(stepIndex) {
            const steps = document.querySelectorAll('.form-step');
            const progressSteps = document.querySelectorAll('.progress-step');
            
            // Hide all steps
            steps.forEach(step => {
                step.classList.remove('active');
            });
            
            // Show current step
            if (steps[stepIndex]) {
                steps[stepIndex].classList.add('active');
            }
            
            // Update progress bar
            progressSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < stepIndex) {
                    step.classList.add('completed');
                } else if (index === stepIndex) {
                    step.classList.add('active');
                }
            });
            
            // Update navigation buttons
            updateNavigationButtons();
            
            // Focus first input in current step
            const firstInput = steps[stepIndex]?.querySelector('input, select, textarea');
            if (firstInput) {
                firstInput.focus();
            }
        }
        
        function updateNavigationButtons() {
            const totalSteps = document.querySelectorAll('.form-step').length;
            
            // Previous button
            if (currentStep === 0) {
                prevBtn.style.display = 'none';
            } else {
                prevBtn.style.display = 'inline-block';
            }
            
            // Next/Submit buttons
            if (currentStep === totalSteps - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'inline-block';
            } else {
                nextBtn.style.display = 'inline-block';
                submitBtn.style.display = 'none';
            }
        }
        
        function changeStep(direction) {
            const totalSteps = document.querySelectorAll('.form-step').length;
            
            // Validate current step before moving forward
            if (direction > 0 && !validateCurrentStep()) {
                return;
            }
            
            // Save current step data
            saveStepData();
            
            // Update step index
            currentStep += direction;
            
            // Ensure step is within bounds
            if (currentStep < 0) {
                currentStep = 0;
            } else if (currentStep >= totalSteps) {
                currentStep = totalSteps - 1;
            }
            
            // Show new step
            showStep(currentStep);
            
            // Generate dynamic fields for next step if needed
            if (direction > 0) {
                generateDynamicFields();
            }
        }
        
        function validateCurrentStep() {
            const currentStepElement = document.querySelector(`.form-step[data-step="${currentStep}"]`);
            const inputs = currentStepElement.querySelectorAll('input, select, textarea');
            let isValid = true;
            
            inputs.forEach(input => {
                if (!validateField(input)) {
                    isValid = false;
                }
            });
            
            return isValid;
        }
        
        function validateField(field) {
            const fieldContainer = field.closest('.form-field');
            const validationMessage = fieldContainer.querySelector('.validation-message');
            
            // Reset validation state
            field.classList.remove('error');
            validationMessage.textContent = '';
            validationMessage.classList.remove('show');
            
            // Check HTML5 validation
            if (!field.checkValidity()) {
                field.classList.add('error');
                validationMessage.textContent = field.validationMessage;
                validationMessage.classList.add('show');
                return false;
            }
            
            // Custom validation can be added here
            
            return true;
        }
        
        function saveStepData() {
            const currentStepElement = document.querySelector(`.form-step[data-step="${currentStep}"]`);
            const inputs = currentStepElement.querySelectorAll('input, select, textarea');
            
            inputs.forEach(input => {
                if (input.type === 'checkbox') {
                    if (input.name.endsWith('[]')) {
                        // Multiple checkboxes
                        const name = input.name.slice(0, -2);
                        if (!formData[name]) {
                            formData[name] = [];
                        }
                        if (input.checked && !formData[name].includes(input.value)) {
                            formData[name].push(input.value);
                        } else if (!input.checked) {
                            formData[name] = formData[name].filter(v => v !== input.value);
                        }
                    } else {
                        // Single checkbox
                        formData[input.name] = input.checked;
                    }
                } else if (input.type === 'radio') {
                    if (input.checked) {
                        formData[input.name] = input.value;
                    }
                } else {
                    formData[input.name] = input.value;
                }
            });
            
            saveProgress();
        }
        
        function saveProgress() {
            if (typeof(Storage) !== "undefined") {
                localStorage.setItem('formWizardData', JSON.stringify(formData));
                localStorage.setItem('formWizardStep', currentStep);
            }
        }
        
        function loadSavedProgress() {
            if (typeof(Storage) !== "undefined") {
                const savedData = localStorage.getItem('formWizardData');
                const savedStep = localStorage.getItem('formWizardStep');
                
                if (savedData) {
                    Object.assign(formData, JSON.parse(savedData));
                    populateFormFields();
                }
                
                if (savedStep) {
                    currentStep = parseInt(savedStep);
                    showStep(currentStep);
                }
            }
        }
        
        function populateFormFields() {
            Object.keys(formData).forEach(fieldName => {
                const value = formData[fieldName];
                const fields = document.querySelectorAll(`[name="${fieldName}"], [name="${fieldName}[]"]`);
                
                fields.forEach(field => {
                    if (field.type === 'checkbox') {
                        if (Array.isArray(value)) {
                            field.checked = value.includes(field.value);
                        } else {
                            field.checked = value;
                        }
                    } else if (field.type === 'radio') {
                        field.checked = field.value === value;
                    } else {
                        field.value = value;
                    }
                });
            });
        }
        
        function generateDynamicFields() {
            // This function would be customized based on your specific needs
            // It can modify the DOM to add/remove fields based on formData
        }
        
        function handleSubmit(e) {
            e.preventDefault();
            
            if (!validateCurrentStep()) {
                return;
            }
            
            saveStepData();
            showSummary();
        }
        
        function showSummary() {
            const summaryContent = document.getElementById('summaryContent');
            summaryContent.innerHTML = '';
            
            // Group data by steps
            document.querySelectorAll('.form-step').forEach((step, index) => {
                const stepTitle = step.querySelector('h2').textContent;
                const section = document.createElement('div');
                section.className = 'summary-section';
                section.innerHTML = `<h3>${stepTitle}</h3>`;
                
                const fields = step.querySelectorAll('.form-field');
                fields.forEach(fieldContainer => {
                    const fieldName = fieldContainer.dataset.fieldName;
                    if (formData[fieldName] !== undefined && formData[fieldName] !== '') {
                        const label = fieldContainer.querySelector('label').textContent.replace('*', '').trim();
                        const value = Array.isArray(formData[fieldName]) 
                            ? formData[fieldName].join(', ') 
                            : formData[fieldName];
                        
                        const fieldDiv = document.createElement('div');
                        fieldDiv.className = 'summary-field';
                        fieldDiv.innerHTML = `
                            <span class="summary-label">${label}:</span>
                            <span class="summary-value">${value}</span>
                        `;
                        section.appendChild(fieldDiv);
                    }
                });
                
                if (section.querySelector('.summary-field')) {
                    summaryContent.appendChild(section);
                }
            });
            
            // Hide form and show summary
            form.style.display = 'none';
            summaryContainer.style.display = 'block';
        }
        
        function editForm() {
            form.style.display = 'block';
            summaryContainer.style.display = 'none';
        }
        
        function confirmSubmission() {
            // Create form data object
            const formDataObj = new FormData();
            Object.keys(formData).forEach(key => {
                if (Array.isArray(formData[key])) {
                    formData[key].forEach(value => {
                        formDataObj.append(key, value);
                    });
                } else {
                    formDataObj.append(key, formData[key]);
                }
            });
            
            // Submit form via AJAX
            fetch(form.action, {
                method: form.method,
                body: formDataObj
            })
            .then(response => response.json())
            .then(data => {
                alert('Form submitted successfully!');
                clearProgress();
            })
            .catch(error => {
                alert('Error submitting form: ' + error.message);
            });
        }
        
        function clearProgress() {
            if (typeof(Storage) !== "undefined") {
                localStorage.removeItem('formWizardData');
                localStorage.removeItem('formWizardStep');
            }
        }
    </script>

</body>
</html>
